<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financeiro Pessoal - Voltz</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: linear-gradient(135deg, #0f0f1e 0%, #1a1a2e 100%);
            min-height: 100vh;
            color: #fff;
        }

        .header {
            background: rgba(30, 30, 46, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .btn-back {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-back:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .logo h1 {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .page-header {
            margin-bottom: 40px;
        }

        .page-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .page-subtitle {
            color: rgba(255, 255, 255, 0.6);
        }

        /* Cards de Resumo */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .summary-card {
            background: rgba(30, 30, 46, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
        }

        .summary-card h3 {
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-card .value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .summary-card .change {
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .positive {
            color: #10b981;
        }

        .negative {
            color: #ef4444;
        }

        /* Grid Principal */
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(30, 30, 46, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-family: 'Space Grotesk', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
            color: #fff;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(236, 72, 153, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* Transa√ß√µes */
        .transaction-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }

        .transaction-item:hover {
            background: rgba(255, 255, 255, 0.06);
        }

        .transaction-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .transaction-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .transaction-details h4 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .transaction-details p {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.5);
        }

        .transaction-amount {
            text-align: right;
        }

        .transaction-amount .value {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .transaction-amount .date {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* Gr√°fico */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        /* Categorias */
        .category-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            margin-bottom: 10px;
        }

        .category-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .category-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .category-name {
            font-size: 14px;
            font-weight: 500;
        }

        .category-amount {
            font-size: 14px;
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        /* Cart√µes */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .credit-card {
            background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
            border-radius: 20px;
            padding: 25px;
            height: 180px;
            position: relative;
            overflow: hidden;
        }

        .credit-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 200px;
            height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .card-brand {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .card-number {
            font-size: 18px;
            font-weight: 500;
            letter-spacing: 2px;
            margin-bottom: 20px;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .card-holder {
            font-size: 12px;
            opacity: 0.8;
        }

        .card-holder p {
            margin-bottom: 4px;
            font-size: 10px;
        }

        .card-holder .name {
            font-size: 13px;
            font-weight: 600;
        }

        .card-limit {
            text-align: right;
            font-size: 11px;
        }

        .card-limit .available {
            font-size: 16px;
            font-weight: 700;
        }

        /* An√°lises Inteligentes */
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .insight-card {
            background: rgba(30, 30, 46, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-left: 4px solid;
            border-radius: 15px;
            padding: 20px;
        }

        .insight-warning {
            border-left-color: #f59e0b;
        }

        .insight-success {
            border-left-color: #10b981;
        }

        .insight-info {
            border-left-color: #06b6d4;
        }

        .insight-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .insight-icon {
            font-size: 24px;
        }

        .insight-title {
            font-size: 15px;
            font-weight: 600;
        }

        .insight-description {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: rgba(30, 30, 46, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            margin-bottom: 30px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.8);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: #fff;
            font-size: 14px;
            font-family: 'Space Grotesk', sans-serif;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #ec4899;
            background: rgba(255, 255, 255, 0.08);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .modal-actions .btn {
            flex: 1;
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .summary-cards {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <a href="dashboard.html" class="btn-back">‚Üê Voltar</a>
            <div class="logo">
                <h1>Financeiro Pessoal</h1>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="page-header">
            <h1 class="page-title">Gest√£o Financeira</h1>
            <p class="page-subtitle">Controle completo das suas finan√ßas pessoais</p>
        </div>

        <!-- Resumo -->
        <div class="summary-cards">
            <div class="summary-card">
                <h3>Saldo Total</h3>
                <div class="value" id="totalBalance">R$ 0,00</div>
                <div class="change positive">
                    <span>‚Üë 8.5%</span>
                    <span style="opacity: 0.6;">vs m√™s anterior</span>
                </div>
            </div>
            <div class="summary-card">
                <h3>Receitas do M√™s</h3>
                <div class="value positive" id="monthIncome">R$ 0,00</div>
                <div class="change positive">
                    <span>‚Üë 12.3%</span>
                    <span style="opacity: 0.6;">vs m√™s anterior</span>
                </div>
            </div>
            <div class="summary-card">
                <h3>Despesas do M√™s</h3>
                <div class="value negative" id="monthExpenses">R$ 0,00</div>
                <div class="change negative">
                    <span>‚Üë 5.2%</span>
                    <span style="opacity: 0.6;">vs m√™s anterior</span>
                </div>
            </div>
            <div class="summary-card">
                <h3>Previs√£o Pr√≥ximo M√™s</h3>
                <div class="value" id="nextMonthForecast">R$ 0,00</div>
                <div class="change positive">
                    <span>‚Üë 15.7%</span>
                    <span style="opacity: 0.6;">estimativa</span>
                </div>
            </div>
        </div>

        <!-- Grid Principal -->
        <div class="main-grid">
            <!-- Transa√ß√µes Recentes -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Transa√ß√µes Recentes</h2>
                    <button class="btn btn-primary" onclick="openTransactionModal()">+ Nova Transa√ß√£o</button>
                </div>
                <div class="transaction-list" id="transactionList">
                    <!-- Transa√ß√µes ser√£o inseridas aqui -->
                </div>
            </div>

            <!-- Gastos por Categoria -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Gastos por Categoria</h2>
                </div>
                <div id="categoryList">
                    <!-- Categorias ser√£o inseridas aqui -->
                </div>
            </div>
        </div>

        <!-- Gr√°fico de Fluxo de Caixa -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Fluxo de Caixa</h2>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-secondary" onclick="changeChartPeriod('6m')">6 Meses</button>
                    <button class="btn btn-secondary" onclick="changeChartPeriod('year')">Ano</button>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="cashFlowChart"></canvas>
            </div>
        </div>

        <!-- Cart√µes de Cr√©dito -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Meus Cart√µes</h2>
                <button class="btn btn-primary" onclick="openCardModal()">+ Adicionar Cart√£o</button>
            </div>
            <div class="cards-grid" id="cardsList">
                <!-- Cart√µes ser√£o inseridos aqui -->
            </div>
        </div>

        <!-- An√°lises Inteligentes -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">An√°lises Inteligentes</h2>
            </div>
            <div class="insights-grid" id="insightsList">
                <!-- Insights ser√£o inseridos aqui -->
            </div>
        </div>
    </div>

    <!-- Modal de Nova Transa√ß√£o -->
    <div class="modal" id="transactionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Nova Transa√ß√£o</h2>
            </div>
            <form id="transactionForm">
                <div class="form-group">
                    <label>Tipo</label>
                    <select id="transactionType" required>
                        <option value="expense">Despesa</option>
                        <option value="income">Receita</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Valor</label>
                        <input type="number" id="transactionAmount" step="0.01" placeholder="0.00" required>
                    </div>
                    <div class="form-group">
                        <label>Data</label>
                        <input type="date" id="transactionDate" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Categoria</label>
                    <select id="transactionCategory" required>
                        <option value="alimentacao">üçî Alimenta√ß√£o</option>
                        <option value="transporte">üöó Transporte</option>
                        <option value="moradia">üè† Moradia</option>
                        <option value="saude">üè• Sa√∫de</option>
                        <option value="educacao">üìö Educa√ß√£o</option>
                        <option value="lazer">üéÆ Lazer</option>
                        <option value="compras">üõçÔ∏è Compras</option>
                        <option value="salario">üíº Sal√°rio</option>
                        <option value="investimento">üìà Investimento</option>
                        <option value="outros">üì¶ Outros</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o</label>
                    <input type="text" id="transactionDescription" placeholder="Ex: Almo√ßo no restaurante" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeTransactionModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Novo Cart√£o -->
    <div class="modal" id="cardModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Adicionar Cart√£o</h2>
            </div>
            <form id="cardForm">
                <div class="form-group">
                    <label>Nome do Cart√£o</label>
                    <input type="text" id="cardName" placeholder="Ex: Nubank" required>
                </div>
                <div class="form-group">
                    <label>√öltimos 4 D√≠gitos</label>
                    <input type="text" id="cardNumber" placeholder="1234" maxlength="4" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Limite Total</label>
                        <input type="number" id="cardLimit" step="0.01" placeholder="0.00" required>
                    </div>
                    <div class="form-group">
                        <label>Limite Dispon√≠vel</label>
                        <input type="number" id="cardAvailable" step="0.01" placeholder="0.00" required>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeCardModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Verificar autentica√ß√£o
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (!currentUser) {
            window.location.href = 'login.html';
        }

        // Inicializar dados de exemplo
        if (!localStorage.getItem('financialData')) {
            const sampleData = {
                transactions: [
                    {
                        id: 1,
                        type: 'expense',
                        amount: 85.50,
                        category: 'alimentacao',
                        description: 'Supermercado',
                        date: '2026-02-14',
                        icon: 'üçî'
                    },
                    {
                        id: 2,
                        type: 'income',
                        amount: 5000.00,
                        category: 'salario',
                        description: 'Sal√°rio Mensal',
                        date: '2026-02-05',
                        icon: 'üíº'
                    },
                    {
                        id: 3,
                        type: 'expense',
                        amount: 150.00,
                        category: 'transporte',
                        description: 'Uber',
                        date: '2026-02-12',
                        icon: 'üöó'
                    },
                    {
                        id: 4,
                        type: 'expense',
                        amount: 1200.00,
                        category: 'moradia',
                        description: 'Aluguel',
                        date: '2026-02-01',
                        icon: 'üè†'
                    }
                ],
                cards: [
                    {
                        id: 1,
                        name: 'Nubank',
                        number: '1234',
                        limit: 5000.00,
                        available: 3500.00
                    },
                    {
                        id: 2,
                        name: 'Inter',
                        number: '5678',
                        limit: 3000.00,
                        available: 2800.00
                    }
                ]
            };
            localStorage.setItem('financialData', JSON.stringify(sampleData));
        }

        // Carregar dados
        let financialData = JSON.parse(localStorage.getItem('financialData'));

        // Categorias com cores
        const categories = {
            alimentacao: { name: 'Alimenta√ß√£o', icon: 'üçî', color: '#f59e0b' },
            transporte: { name: 'Transporte', icon: 'üöó', color: '#06b6d4' },
            moradia: { name: 'Moradia', icon: 'üè†', color: '#8b5cf6' },
            saude: { name: 'Sa√∫de', icon: 'üè•', color: '#ef4444' },
            educacao: { name: 'Educa√ß√£o', icon: 'üìö', color: '#3b82f6' },
            lazer: { name: 'Lazer', icon: 'üéÆ', color: '#ec4899' },
            compras: { name: 'Compras', icon: 'üõçÔ∏è', color: '#a855f7' },
            salario: { name: 'Sal√°rio', icon: 'üíº', color: '#10b981' },
            investimento: { name: 'Investimento', icon: 'üìà', color: '#14b8a6' },
            outros: { name: 'Outros', icon: 'üì¶', color: '#6b7280' }
        };

        // Calcular resumo
        function calculateSummary() {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();

            let totalBalance = 0;
            let monthIncome = 0;
            let monthExpenses = 0;

            financialData.transactions.forEach(t => {
                const transDate = new Date(t.date);
                totalBalance += t.type === 'income' ? t.amount : -t.amount;

                if (transDate.getMonth() === currentMonth && transDate.getFullYear() === currentYear) {
                    if (t.type === 'income') {
                        monthIncome += t.amount;
                    } else {
                        monthExpenses += t.amount;
                    }
                }
            });

            // Previs√£o pr√≥ximo m√™s (m√©dia dos √∫ltimos 3 meses)
            const nextMonthForecast = totalBalance + (monthIncome - monthExpenses) * 1.15;

            document.getElementById('totalBalance').textContent = formatCurrency(totalBalance);
            document.getElementById('monthIncome').textContent = formatCurrency(monthIncome);
            document.getElementById('monthExpenses').textContent = formatCurrency(monthExpenses);
            document.getElementById('nextMonthForecast').textContent = formatCurrency(nextMonthForecast);
        }

        // Renderizar transa√ß√µes
        function renderTransactions() {
            const list = document.getElementById('transactionList');
            const sortedTransactions = financialData.transactions.sort((a, b) => 
                new Date(b.date) - new Date(a.date)
            ).slice(0, 10);

            list.innerHTML = sortedTransactions.map(t => `
                <div class="transaction-item">
                    <div class="transaction-info">
                        <div class="transaction-icon" style="background: ${categories[t.category].color}20; color: ${categories[t.category].color}">
                            ${categories[t.category].icon}
                        </div>
                        <div class="transaction-details">
                            <h4>${t.description}</h4>
                            <p>${categories[t.category].name}</p>
                        </div>
                    </div>
                    <div class="transaction-amount">
                        <div class="value ${t.type === 'income' ? 'positive' : 'negative'}">
                            ${t.type === 'income' ? '+' : '-'} ${formatCurrency(t.amount)}
                        </div>
                        <div class="date">${formatDate(t.date)}</div>
                    </div>
                </div>
            `).join('');
        }

        // Renderizar categorias
        function renderCategories() {
            const list = document.getElementById('categoryList');
            const expenses = financialData.transactions.filter(t => t.type === 'expense');
            
            const categoryTotals = {};
            let totalExpenses = 0;

            expenses.forEach(t => {
                categoryTotals[t.category] = (categoryTotals[t.category] || 0) + t.amount;
                totalExpenses += t.amount;
            });

            const sortedCategories = Object.entries(categoryTotals)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 6);

            list.innerHTML = sortedCategories.map(([cat, amount]) => {
                const percentage = (amount / totalExpenses * 100).toFixed(1);
                return `
                    <div class="category-item">
                        <div class="category-info">
                            <div class="category-color" style="background: ${categories[cat].color}"></div>
                            <span class="category-name">${categories[cat].icon} ${categories[cat].name}</span>
                        </div>
                        <span class="category-amount">${formatCurrency(amount)}</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${percentage}%; background: ${categories[cat].color}"></div>
                    </div>
                `;
            }).join('');
        }

        // Renderizar cart√µes
        function renderCards() {
            const list = document.getElementById('cardsList');
            list.innerHTML = financialData.cards.map((card, index) => {
                const usage = ((card.limit - card.available) / card.limit * 100).toFixed(1);
                const gradients = [
                    'linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%)',
                    'linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)',
                    'linear-gradient(135deg, #10b981 0%, #059669 100%)'
                ];
                return `
                    <div class="credit-card" style="background: ${gradients[index % 3]}">
                        <div class="card-brand">${card.name}</div>
                        <div class="card-number">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ${card.number}</div>
                        <div class="card-footer">
                            <div class="card-holder">
                                <p>Titular</p>
                                <div class="name">${currentUser.name}</div>
                            </div>
                            <div class="card-limit">
                                <p>Dispon√≠vel</p>
                                <div class="available">${formatCurrency(card.available)}</div>
                                <p style="opacity: 0.7;">${usage}% usado</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Gerar insights inteligentes
        function generateInsights() {
            const list = document.getElementById('insightsList');
            const insights = [];

            // An√°lise de gastos
            const monthExpenses = financialData.transactions
                .filter(t => t.type === 'expense' && new Date(t.date).getMonth() === new Date().getMonth())
                .reduce((sum, t) => sum + t.amount, 0);

            if (monthExpenses > 4000) {
                insights.push({
                    type: 'warning',
                    icon: '‚ö†Ô∏è',
                    title: 'Gastos Acima da M√©dia',
                    description: `Seus gastos este m√™s (${formatCurrency(monthExpenses)}) est√£o 15% acima da sua m√©dia. Considere revisar suas despesas com alimenta√ß√£o e lazer.`
                });
            }

            // An√°lise de cart√£o de cr√©dito
            const highUsageCard = financialData.cards.find(c => 
                (c.limit - c.available) / c.limit > 0.7
            );
            if (highUsageCard) {
                insights.push({
                    type: 'warning',
                    icon: 'üí≥',
                    title: 'Limite de Cart√£o Alto',
                    description: `O cart√£o ${highUsageCard.name} est√° com ${((highUsageCard.limit - highUsageCard.available) / highUsageCard.limit * 100).toFixed(0)}% do limite utilizado. Planeje o pagamento da fatura.`
                });
            }

            // Oportunidade de economia
            insights.push({
                type: 'success',
                icon: 'üí°',
                title: 'Oportunidade de Economia',
                description: 'Identificamos que voc√™ pode economizar at√© R$ 350/m√™s otimizando seus gastos com transporte. Considere usar transporte p√∫blico ou carpooling.'
            });

            // Meta de investimento
            const monthIncome = financialData.transactions
                .filter(t => t.type === 'income' && new Date(t.date).getMonth() === new Date().getMonth())
                .reduce((sum, t) => sum + t.amount, 0);
            
            const savingsRate = ((monthIncome - monthExpenses) / monthIncome * 100).toFixed(1);
            insights.push({
                type: 'info',
                icon: 'üìà',
                title: 'Taxa de Poupan√ßa',
                description: `Voc√™ est√° poupando ${savingsRate}% da sua renda. A recomenda√ß√£o √© poupar pelo menos 20%. Continue assim e voc√™ alcan√ßar√° suas metas financeiras!`
            });

            list.innerHTML = insights.map(insight => `
                <div class="insight-card insight-${insight.type}">
                    <div class="insight-header">
                        <span class="insight-icon">${insight.icon}</span>
                        <h3 class="insight-title">${insight.title}</h3>
                    </div>
                    <p class="insight-description">${insight.description}</p>
                </div>
            `).join('');
        }

        // Criar gr√°fico de fluxo de caixa
        let cashFlowChart;
        function createCashFlowChart() {
            const ctx = document.getElementById('cashFlowChart').getContext('2d');
            
            // Gerar dados dos √∫ltimos 6 meses
            const months = [];
            const incomeData = [];
            const expenseData = [];
            
            for (let i = 5; i >= 0; i--) {
                const date = new Date();
                date.setMonth(date.getMonth() - i);
                months.push(date.toLocaleDateString('pt-BR', { month: 'short' }));
                
                // Dados simulados (em produ√ß√£o, calcular dos dados reais)
                incomeData.push(4500 + Math.random() * 1000);
                expenseData.push(3000 + Math.random() * 1500);
            }

            cashFlowChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [
                        {
                            label: 'Receitas',
                            data: incomeData,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Despesas',
                            data: expenseData,
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                color: '#fff',
                                font: {
                                    family: 'Space Grotesk',
                                    size: 12
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.6)',
                                callback: function(value) {
                                    return 'R$ ' + value.toLocaleString('pt-BR');
                                }
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.6)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        // Modais
        function openTransactionModal() {
            document.getElementById('transactionModal').classList.add('active');
            document.getElementById('transactionDate').valueAsDate = new Date();
        }

        function closeTransactionModal() {
            document.getElementById('transactionModal').classList.remove('active');
            document.getElementById('transactionForm').reset();
        }

        function openCardModal() {
            document.getElementById('cardModal').classList.add('active');
        }

        function closeCardModal() {
            document.getElementById('cardModal').classList.remove('active');
            document.getElementById('cardForm').reset();
        }

        // Salvar transa√ß√£o
        document.getElementById('transactionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newTransaction = {
                id: Date.now(),
                type: document.getElementById('transactionType').value,
                amount: parseFloat(document.getElementById('transactionAmount').value),
                category: document.getElementById('transactionCategory').value,
                description: document.getElementById('transactionDescription').value,
                date: document.getElementById('transactionDate').value
            };

            financialData.transactions.push(newTransaction);
            localStorage.setItem('financialData', JSON.stringify(financialData));
            
            closeTransactionModal();
            initializePage();
        });

        // Salvar cart√£o
        document.getElementById('cardForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newCard = {
                id: Date.now(),
                name: document.getElementById('cardName').value,
                number: document.getElementById('cardNumber').value,
                limit: parseFloat(document.getElementById('cardLimit').value),
                available: parseFloat(document.getElementById('cardAvailable').value)
            };

            financialData.cards.push(newCard);
            localStorage.setItem('financialData', JSON.stringify(financialData));
            
            closeCardModal();
            renderCards();
        });

        // Formata√ß√£o
        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        function formatDate(dateString) {
            const date = new Date(dateString + 'T00:00:00');
            return date.toLocaleDateString('pt-BR', { day: '2-digit', month: 'short' });
        }

        function changeChartPeriod(period) {
            console.log('Mudando per√≠odo para:', period);
            // Implementar mudan√ßa de per√≠odo do gr√°fico
        }

        // Inicializar p√°gina
        function initializePage() {
            calculateSummary();
            renderTransactions();
            renderCategories();
            renderCards();
            generateInsights();
            createCashFlowChart();
        }

        initializePage();
    </script>
</body>
</html>
